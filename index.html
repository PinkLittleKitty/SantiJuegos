<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SantiJuegos</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>üéÆ SantiJuegos</h1>
        <div class="search-container">
            <input type="text" id="searchGames" placeholder="Buscar Juegos...">
            <select id="categoryFilter">
                <option value="all">All Systems</option>
                <option value="nes">Nintendo (NES)</option>
                <option value="snes">Super Nintendo</option>
                <option value="gb">Game Boy</option>
                <option value="gba">Game Boy Advance</option>
                <option value="n64">Nintendo 64</option>
                <option value="psx">PlayStation</option>
            </select>
        </div>
    </header>
      <div class="game-grid">
      </div>
        <script>
            function generateGameCards() {
                const gameGrid = document.querySelector('.game-grid');
                gameGrid.innerHTML = '';

                Object.entries(retroGames).forEach(([system, systemData]) => {
                    Object.entries(systemData.games).forEach(([gameId, gameData]) => {
                        const card = document.createElement('div');
                        card.className = 'game-card';
                        card.dataset.system = system;
                        card.style.backgroundImage = `url(${gameData.art})`;
                        
                        card.innerHTML = `
                            <span class="game-console-badge">${systemData.displayName}</span>
                            <h3>${gameData.title}</h3>
                            <button class="play-button" onclick="loadGame('${system}_${gameId}')">Jugar!</button>
                        `;
                        
                        gameGrid.appendChild(card);
                    });
                });
            }
            function loadGame(gameId) {
                console.log('loadGame called with:', gameId);
                const [system, game] = gameId.split('_');
                if (retroGames[system]?.games[game]) {
                    const gameData = retroGames[system].games[game];
                    console.log('System:', system);
                    console.log('Game:', game);
                    console.log('ROM path:', gameData.rom);
                    const emulatorUrl = `./emulator/index.html?core=${system}&rom=./${gameData.rom}`;
                    console.log('Final URL:', emulatorUrl);

                    const modal = document.getElementById('gameModal');
                    const gameFrame = document.getElementById('gameFrame');
                    gameFrame.src = emulatorUrl;
                    modal.style.display = 'block';
                }
            }
            document.addEventListener('DOMContentLoaded', () => {
                console.log('DOM loaded, generating cards');
                generateGameCards();
            });
      </script>
    <div id="gameModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeGame()">√ó</span>
            <iframe id="gameFrame" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>

    <script>

        const retroGames = {
            'nes': {
                displayName: 'Nintendo Entertainment System',
                games: {
                    'tetris': {
                        title: 'Tetris',
                        art: 'retro/boxart/nes/tetris.png',
                        rom: 'retro/roms/nes/tetris.nes'
                    }
                }
            },
            'gb': {
                displayName: 'Game Boy',
                games: {
                    'pokemon_red': {
                        title: 'Pokemon Red',
                        art: 'retro/boxart/gb/pokemon_red.jpg',
                        rom: 'retro/roms/gb/pokemon_red.gb'
                    },
                    'zelda_dx': {
                        title: 'The Legend of Zelda DX',
                        art: 'retro/boxart/gb/zelda_dx.jpg', 
                        rom: 'retro/roms/gb/zelda_dx.gb'
                    }
                }
            },
            'snes': {
                displayName: 'Super Nintendo',
                games: {
                    'super_mario_world': {
                        title: 'Super Mario World',
                        art: 'assets/boxart/snes/super_mario_world.jpg',
                        rom: 'retro/roms/snes/super_mario_world.sfc'
                    }
                }
            }
        };

        const gameUrls = {
            'mario': '/emulator/index.html?core=snes&rom=super_mario_world.sfc',
            'pokemon': '/emulator/index.html?core=gb&rom=pokemon_red.gb',
            'sonic': '/emulator/index.html?core=segamd&rom=sonic.md'
        };

        // Search and filter functionality
        document.getElementById('searchGames').addEventListener('input', filterGames);
        document.getElementById('categoryFilter').addEventListener('change', filterGames);

        function filterGames() {
            const searchTerm = document.getElementById('searchGames').value.toLowerCase();
            const system = document.getElementById('categoryFilter').value;
            const games = document.querySelectorAll('.game-card');

            games.forEach(game => {
                const gameTitle = game.querySelector('h3').textContent.toLowerCase();
                const gameSystem = game.dataset.system;
                const matchesSearch = gameTitle.includes(searchTerm);
                const matchesSystem = system === 'all' || gameSystem === system;
                
                game.style.display = matchesSearch && matchesSystem ? 'block' : 'none';
            });
        }

        // Favorites system
        function toggleFavorite(gameName) {
            let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const index = favorites.indexOf(gameName);
            
            if (index === -1) {
                favorites.push(gameName);
            } else {
                favorites.splice(index, 1);
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoriteButtons();
        }

        function updateFavoriteButtons() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            document.querySelectorAll('.favorite-btn').forEach(btn => {
                const gameName = btn.parentElement.querySelector('h3').textContent.toLowerCase();
                btn.textContent = favorites.includes(gameName) ? '‚ù§Ô∏è' : 'ü§ç';
            });
        }

        function closeGame() {
            const modal = document.getElementById('gameModal');
            const gameFrame = document.getElementById('gameFrame');
            modal.style.display = 'none';
            gameFrame.src = '';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('gameModal');
            if (event.target == modal) {
                closeGame();
            }
        }

        // Initialize favorites on page load
        updateFavoriteButtons();
    </script>
</body>
</html>